# POS Bridge - Service เบชเบณเบฅเบฑเบเปเบเบทเปเบญเบกเบเปเป POS เบเบฑเบ Printer

เปเบเบผเปเบเบฑเบเบเบตเปเปเบกเปเบ Service Bridge เบเบตเปเปเบฎเบฑเบเบงเบฝเบเปเบเบดเบ Windows, เบชเปเบฒเบเบเบถเปเบเปเบเบเปเบเป Node.js เปเบเบทเปเบญเปเบเบฑเบเบเบปเบงเปเบเบทเปเบญเบกเบเปเปเบฅเบฐเบซเบงเปเบฒเบเบฅเบฐเบเบปเบ Point of Sale (POS) เบเบตเปเปเบเบฑเบเปเบงเบฑเบเปเบญเบฑเบเบเบฅเบดเปเบเบเบฑเบ เปเบฅเบฐ เปเบเบทเปเบญเบเบเบดเบก (Printer) เบเบตเปเบเบดเบเบเบฑเปเบเบขเบนเปเปเบเปเบเบทเปเบญเบเบเบญเบกเบเบดเบงเปเบเบต. Service เบเบตเปเบเบฐเปเบฎเบฑเบเบงเบฝเบเบขเบนเปเปเบเบทเปเบญเบเบซเบผเบฑเบเบเบฐเบซเบผเบญเบเปเบงเบฅเบฒ (Run as a Windows Service) เปเบเบทเปเบญเบฎเบฑเบเบเบณเบชเบฑเปเบเบเบดเบกเบเบฒเบ POS.

## โจ เบเบธเบเบชเบปเบกเบเบฑเบเบซเบผเบฑเบ

- **เปเบฎเบฑเบเบงเบฝเบเปเบเบฑเบ Windows Service:** Service เบเบฐเปเบฅเบตเปเบกเปเบฎเบฑเบเบงเบฝเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบเบเบธเบเบเบฑเปเบเบเบตเปเปเบเบตเบเปเบเบทเปเบญเบ เปเบฅเบฐ เปเบฎเบฑเบเบงเบฝเบเบเปเปเปเบเบทเปเบญเบ.
- **API เบชเบณเบฅเบฑเบเบเบฑเบเบเบฒเบ Printer:**
    - `GET /list-printers`: เบเบถเบเบฅเบฒเบเบเบทเปเปเบเบทเปเบญเบเบเบดเบกเบเบฑเบเปเบปเบเบเบตเป Windows เบฎเบนเปเบเบฑเบ.
    - `POST /print/pdf`: เบฎเบฑเบเบเปเปเบกเบนเบ PDF (เปเบเบฎเบนเบเปเบเบ Base64) เบเปเบญเบกเบเบทเปเปเบเบทเปเบญเบเบเบดเบก เปเบเบทเปเบญเบชเบฑเปเบเบเบดเบก. (เบชเบณเบฅเบฑเบ Windows เบเบฐเปเบเป SumatraPDF เปเบเบทเปเบญเบเบดเบก)
    - `POST /hardware/open-drawer`: เบชเบฑเปเบเปเบเบตเบเบฅเบดเปเบเบเบฑเบเปเบเบฑเบเปเบเบดเบเบเบตเปเปเบเบทเปเบญเบกเบเปเปเบเปเบฒเบ USB.
- **เบเบดเบเบเบฑเปเบเบเปเบฒเบ:** เบกเบตเปเบเบฅเปเบเบดเบเบเบฑเปเบ `.exe` เบชเบณเบฅเบฑเบเปเบซเปเบเบนเปเปเบเปเบเบฒเบเบเบปเปเบงเปเบเบเบดเบเบเบฑเปเบเปเบเปเบเปเบฒเบ.

---

## โ๏ธ เบเบงเบฒเบกเบเปเบญเบเบเบฒเบเบเบญเบเบฅเบฐเบเบปเบ

- Windows 7 (64-bit) เบเบถเปเบเปเบ.
- เบชเบดเบเบเบดเบเบญเบ Administrator เบเบญเบเบเบดเบเบเบฑเปเบ.

---

## ๐ เบเบฒเบเบเบดเบเบเบฑเปเบ (เบชเบณเบฅเบฑเบเบเบนเปเปเบเปเบเบฒเบเบเบปเปเบงเปเบ)

1.  เบเบฒเบงเปเบซเบผเบเปเบเบฅเป `POS_Bridge_Setup_vX.X.X.exe` (X.X.X เปเบกเปเบเปเบงเบตเบเบฑเบ).
2.  เบเบฅเบดเบเบเบงเบฒเปเบชเปเปเบเบฅเป Setup เปเบฅเปเบงเปเบฅเบทเบญเบ **"Run as administrator"**.
3.  เบเบปเบ Next เปเบเบเบฒเบกเบเบฑเปเบเบเบญเบเบเบปเบเบชเบณเปเบฅเบฑเบ.
4.  เปเบกเบทเปเบญเบเบดเบเบเบฑเปเบเบชเบณเปเบฅเบฑเบ, Service เบเบฐเบเบทเบเปเบเบตเบเปเบเปเบเบฒเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ.

**เบงเบดเบเบตเบเบงเบเบชเบญเบเบงเปเบฒ Service เปเบฎเบฑเบเบงเบฝเบเบขเบนเปเบซเบผเบทเบเปเป:**

1.  เปเบเบตเบเปเบเบฃเปเบเบฃเบก **Services** (เบเบดเบก `services.msc` เปเบเธเนเธญเธ Run).
2.  เบเบญเบเบซเบฒ Service เบเบตเปเบเบทเปเบงเปเบฒ **"service print pos app"**.
3.  เบเบงเบเปเบเบดเปเบเบงเปเบฒเบชเบฐเบเบฒเบเบฐ (Status) เปเบเบฑเบ **Running** เปเบฅเบฐ Startup Type เปเบเบฑเบ **Automatic**.
4.  เบซเบผเบฑเบเบเบฒเบเบเบดเบเบเบฑเปเบ, เบฅเบฐเบเบปเบเบเบฐเบชเปเบฒเบ Firewall Rule เปเบเบทเปเบญเบญเบฐเบเบธเบเบฒเบเบเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเปเบฒเบ Port 9100 เบญเบฑเบเบเบฐเปเบเบกเบฑเบ.
5.  เปเบเบตเบ Web Browser เปเบฅเปเบงเปเบเบปเปเบฒเปเบเบเบตเป `http://localhost:9100/list-printers`. เบเปเบฒเปเบซเบฑเบเบฅเบฒเบเบเบทเปเปเบเบทเปเบญเบเบเบดเบกเบชเบฐเปเบเบเบงเปเบฒ Service เปเบฎเบฑเบเบงเบฝเบเบชเบณเปเบฅเบฑเบ.

## ๐ฆ Dependencies เบซเบผเบฑเบ

- **express:** Web server framework.
- **cors:** เปเบเบตเบเปเบซเปเบชเบฒเบกเบฒเบเนเธฃเธตเธขเธเนเธเน API เบเบฒเบ Domain เบญเบทเปเบเปเบเป.
- **body-parser:** เปเบเปเบฎเบฑเบเบเปเปเบกเบนเบ JSON เบเบฒเบ Request.
- **pdf-to-printer:** Library เบซเบผเบฑเบเบเบตเปเปเบเปเบชเบฑเปเบเบเบดเบกเปเบเบฅเป PDF เปเบเบซเบฒ Printer Driver เบเบญเบ Windows.
- **escpos & escpos-usb:** เปเบเปเบชเบณเบฅเบฑเบเบชเบปเปเบเบเบณเบชเบฑเปเบเปเบเบเบเบปเบเปเบเบซเบฒเบญเบธเบเบฐเบเบญเบเปเบเบฑเปเบ: เปเบเบตเบเบฅเบดเปเบเบเบฑเบเปเบเบฑเบเปเบเบดเบ.
- **pkg:** เปเบเป Build Node.js project เปเบซเปเปเบเบฑเบ Executable file.
- **nssm:** เปเบเบทเปเบญเบเบกเบทเบชเบณเบฅเบฑเบเบชเปเบฒเบ เปเบฅเบฐ เบเบฑเบเบเบฒเบ Windows Service.
- **SumatraPDF:** เปเบเบฃเปเบเบฃเบกเบชเบณเบฅเบฑเบเปเบเบตเบเบญเปเบฒเบ เปเบฅเบฐ เบชเบฑเปเบเบเบดเบกเปเบเบฅเป PDF เปเบเบ Silent (เบชเบณเบฅเบฑเบ Windows เปเบเบปเปเบฒเบเบฑเปเบ). เบเบทเบ Bundle เบกเบฒเบเปเบญเบกเบเบฑเบ Installer.

---

## เบเบนเปเบเบฑเบเบเบฐเบเบฒ

- **SornDev เบเบฑเบเบเบฐเบเบฒเบเปเบญเบเปเบง**
- **Facebook:** [https://www.facebook.com/SornDev](https://www.facebook.com/SornDev)
- **เปเบ/WhatsApp:** 020 28729723


---

## ๐จโ๐ป เบเบฒเบเบเบฑเบเบเบฐเบเบฒ (เบชเบณเบฅเบฑเบเบเบฑเบเบเบฑเบเบเบฐเบเบฒ)

เบเปเบฒเบเปเบญเบเบเบฒเบเปเบเปเปเบ เบซเบผเบท เบเบฑเบเบเบฐเบเบฒเปเบเบผเปเบเบฑเบเบเบตเปเบเปเป, เปเบซเปเปเบฎเบฑเบเบเบฒเบกเบเบฑเปเบเบเบญเบเบฅเบธเปเบกเบเบตเป (เปเบเบฐเบเบณเปเบซเปเปเบฎเบฑเบเปเบ Windows):

### 1. เบเบฝเบกเปเบเบทเปเบญเบเบกเบทเบเบตเปเบเบณเปเบเบฑเบ:
- **Node.js:** เปเบงเบตเบเบฑเบ 18 เบเบถเปเบเปเบ.
- **NSIS:** เบเบฒเบงเปเบซเบผเบ เปเบฅเบฐ เบเบดเบเบเบฑเปเบ [NSIS](https://nsis.sourceforge.io/Download).
- **Git:** เบชเบณเบฅเบฑเบ Clone เปเบเบผเปเบเบฑเบ.
- **SumatraPDF.exe:** เบเบฒเบงเปเบซเบผเบเปเบเบฅเป Portable Executable เบเบฒเบ [SumatraPDF Website](https://www.sumatrapdfreader.org/download-free-pdf-viewer). เปเบซเปเปเบเปเปเบเบงเปเบฒเปเบเบฅเปเบเบตเปเบขเบนเปเปเบ Folder เบเบฝเบงเบเบฑเบเบเบฑเบ `create_installer.nsi` เปเบกเบทเปเบญเบชเปเบฒเบ Installer.

### 2. Clone เปเบเบผเปเบเบฑเบ:
```bash
git clone <your-repository-url>
cd POS-BRIDGE-WINDOWS-SERVICE
```

### 3. เบเบดเบเบเบฑเปเบ Dependencies:
เปเบเบตเบ Command Prompt (CMD) เบซเบผเบท PowerShell เปเบเบ **Administrator** เปเบฅเปเบงเบเบดเบกเบเบณเบชเบฑเปเบ:
```bash
npm install
```

### 4. เบฅเบญเบ Run Server เปเบเปเปเบ Development:
```bash
node server.js
```
เบเปเบฒเบเปเปเบกเบตเบซเบเบฑเบเบเบดเบเบเบฒเบ, เบเบฐเปเบซเบฑเบเบเปเปเบเบงเบฒเบก `[service print pos app] is running! Listening on http://localhost:9100`

### 5. เบเบฒเบ Build เปเบเบฅเป Executable (.exe):
เปเบเบผเปเบเบฑเบเบเบตเปเปเบเป `pkg` เปเบเบทเปเบญเบฅเบงเบเบฅเบงเบก Node.js app เปเบซเปเปเบเบฑเบเปเบเบฅเป `.exe` เบเบฝเบเปเบเบฅเปเบเบฝเบง.
```bash
npm run build
```
เบเบณเบชเบฑเปเบเบเบตเปเบเบฐเบชเปเบฒเบเปเบเบฅเป `PosBridge.exe` เบเบถเปเบเบกเบฒ.

### 6. เบเบฒเบเบชเปเบฒเบเบเบปเบงเบเบดเบเบเบฑเปเบ (Installer):
เบซเบผเบฑเบเบเบฒเบเปเบเป `PosBridge.exe` เปเบฅเปเบง, เปเบฎเบปเบฒเบเบฐเปเบเป NSIS เปเบเบทเปเบญเบชเปเบฒเบเปเบเบฅเป Setup.

1.  เปเบซเปเปเบเปเปเบเบงเปเบฒเปเบเบฅเป `PosBridge.exe`, `nssm.exe` เปเบฅเบฐ `SumatraPDF.exe` เบขเบนเปเปเบ Folder เบเบฝเบงเบเบฑเบเบเบฑเบ `create_installer.nsi`.
2.  เบเบฅเบดเบเบเบงเบฒเปเบชเปเปเบเบฅเป `create_installer.nsi` เปเบฅเปเบงเปเบฅเบทเบญเบ **"Compile NSIS Script"**.
3.  เบเปเบฒเบชเบณเปเบฅเบฑเบ, เบเบฐเปเบเปเปเบเบฅเป `POS_Bridge_Setup_v1.1.0.exe` เบญเบญเบเบกเบฒ.

---

## ๐ฆ Dependencies เบซเบผเบฑเบ

- **express:** Web server framework.
- **cors:** เปเบเบตเบเปเบซเปเบชเบฒเบกเบฒเบเนเธฃเธตเธขเธเนเธเน API เบเบฒเบ Domain เบญเบทเปเบเปเบเป.
- **body-parser:** เปเบเปเบฎเบฑเบเธเนเธญเธกเธนเธฅ JSON เบเบฒเบ Request.
- **pdf-to-printer:** Library เบซเบผเบฑเบเบเบตเปเปเบเปเบชเบฑเปเบเบเบดเบกเปเบเบฅเป PDF เปเบเบซเบฒ Printer Driver เบเบญเบ Windows.
- **escpos & escpos-usb:** เปเบเปเบชเบณเบฅเบฑเบเบชเบปเปเบเบเบณเบชเบฑเปเบเปเบเบเบเบปเบเปเบเบซเบฒเบญเบธเบเบฐเบเบญเบเปเบเบฑเปเบ: เปเบเบตเบเบฅเบดเปเบเบเบฑเบเปเบเบฑเบเปเบเบดเบ.
- **pkg:** เปเบเป Build Node.js project เปเบซเปเปเบเบฑเบ Executable file.
- **nssm:** เปเบเบทเปเบญเบเบกเบทเบชเบณเบฅเบฑเบเบชเปเบฒเบ เปเบฅเบฐ เบเบฑเบเบเบฒเบ Windows Service.
- **SumatraPDF:** เปเบเบฃเปเบเบฃเบกเบชเบณเบฅเบฑเบเปเบเบตเบเบญเปเบฒเบ เปเบฅเบฐ เบชเบฑเปเบเบเบดเบกเปเบเบฅเป PDF เปเบเบ Silent (เบชเบณเบฅเบฑเบ Windows เปเบเบปเปเบฒเบเบฑเปเบ). เบเบทเบ Bundle เบกเบฒเบเปเบญเบกเบเบฑเบ Installer.

---

## เบเบนเปเบเบฑเบเบเบฐเบเบฒ

- **SornDev เบเบฑเบเบเบฐเบเบฒเบเปเบญเบเปเบง**
- **Facebook:** [https://www.facebook.com/SornDev](https://www.facebook.com/SornDev)
- **เปเบ/WhatsApp:** 020 28729723
