# POS Bridge - Service เบชเบณเบฅเบฑเบเปเบเบทเปเบญเบกเบเปเป POS เบเบฑเบ Printer

เปเบเบผเปเบเบฑเบเบเบตเปเปเบกเปเบ Service Bridge เบเบตเปเปเบฎเบฑเบเบงเบฝเบเปเบเบดเบ Windows, macOS, เปเบฅเบฐ Linux, เบชเปเบฒเบเบเบถเปเบเปเบเบเปเบเป Node.js เปเบเบทเปเบญเปเบเบฑเบเบเบปเบงเปเบเบทเปเบญเบกเบเปเปเบฅเบฐเบซเบงเปเบฒเบเบฅเบฐเบเบปเบ Point of Sale (POS) เปเบฅเบฐ เปเบเบทเปเบญเบเบเบดเบก (Printer). Service เบเบตเปเบเบฐเปเบฎเบฑเบเบงเบฝเบเบขเบนเปเปเบเบทเปเบญเบเบซเบผเบฑเบเบเบฐเบซเบผเบญเบเปเบงเบฅเบฒ (Run as a Service/Daemon) เปเบเบทเปเบญเบฎเบฑเบเบเบณเบชเบฑเปเบเบเบดเบกเบเบฒเบ POS เปเบเบเบเบปเบ เบซเบผเบท เบเบถเบเบฅเบฒเบเบเบฒเบเบเบดเบกเบเบฒเบ Server เบซเบผเบฑเบ.

## โจ เบเบธเบเบชเบปเบกเบเบฑเบเบซเบผเบฑเบ

- **Cross-Platform:** เบฎเบญเบเบฎเบฑเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบเบเบฑเบเปเบ Windows, macOS, เปเบฅเบฐ Linux.
- **Polling เบเบฒเบ Server:** เบเบถเบเบฅเบฒเบเบเบฒเบเบเบดเบก (Print Jobs) เบเบตเปเบเปเบฒเบเบขเบนเปเบเบฒเบ API Server (เปเบเบฑเปเบ: Laravel Backend) เปเบเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบเบเบฒเบกเปเบฅเบเบฐเปเบงเบฅเบฒเบเบตเปเบเบณเบเบปเบ, เปเบฎเบฑเบเปเบซเปเบเบฒเบเบเบดเบกเปเบเบฑเบเปเบเบ Asynchronous.
- **เปเบฎเบฑเบเบงเบฝเบเปเบเบฑเบ Service:** เปเบฅเบตเปเบกเปเบฎเบฑเบเบงเบฝเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบเปเบกเบทเปเบญเปเบเบตเบเปเบเบทเปเบญเบ เปเบฅเบฐ เปเบฎเบฑเบเบงเบฝเบเบเปเปเปเบเบทเปเบญเบ.
- **Direct API:** เบกเบต API เบชเบณเบฅเบฑเบเบชเบฑเปเบเบเบดเบก เบซเบผเบท เบเบฑเบเบเบฒเบเบญเบธเบเบฐเบเบญเบเปเบเบเบเบปเบเบเบฒเบ POS Web App.
- **เบเบดเบเบเบฑเปเบเบเปเบฒเบ:** เบกเบตเปเบเบฅเปเบเบดเบเบเบฑเปเบ `.exe` เบชเบณเบฅเบฑเบ Windows.

---

## โ๏ธ เบเบฒเบเบเบฑเปเบเบเปเบฒ (Configuration)

Service เบเบตเปเปเบเปเปเบเบฅเป `config.json` เปเบเบทเปเบญเบเบฑเปเบเบเปเบฒเบเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเบฑเบ Server เบซเบผเบฑเบ. เปเบเบฅเปเบเบตเปเบเปเบญเบเบเบทเบเบชเปเบฒเบ เปเบฅเบฐ เบงเบฒเบเปเบงเปเปเบ Folder เบเบฝเบงเบเบฑเบเบเบฑเบเปเบเบฅเปเบเบตเปเปเบเป Run Service (เปเบเบฑเปเบ `PosBridge.exe` เบซเบผเบท `server.js`).

**เบเบปเบงเบขเปเบฒเบเปเบเบทเปเบญเปเบเบเบญเบ `config.json`:**
```json
{
  "LARAVEL_API_URL": "http://your-laravel-app.com/api",
  "POLLING_INTERVAL_MS": 10000
}
```
- `LARAVEL_API_URL`: URL เบเบญเบ API เบเบตเป Service เบเบฐเปเบเบเบถเบเบฅเบฒเบเบเบฒเบเบเบดเบก.
- `POLLING_INTERVAL_MS`: เปเบฅเบเบฐเปเบงเบฅเบฒเปเบเบเบฒเบเบเบงเบเบชเบญเบเบฅเบฒเบเบเบฒเบเบเบดเบกเปเปเป (๋จ์: เบกเบดเบเบฅเบดเบงเบดเบเบฒเบเบต, `10000` = 10 เบงเบดเบเบฒเบเบต).

---

## ๐ เบซเบผเบฑเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบ เปเบฅเบฐ API

Service เบเบตเปเปเบฎเบฑเบเบงเบฝเบ 2 เบฎเบนเบเปเบเบ song song เบเบฑเบ:

### 1. เปเปเบ Polling (เปเบเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ)
เบเบตเปเปเบกเปเบเปเปเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบเบซเบผเบฑเบ. Service เบเบฐเบเบงเบเบชเบญเบเบฅเบฒเบเบเบฒเบเบเบดเบกเปเปเปเบเบฒเบ API Server เบขเปเบฒเบเบเปเปเปเบเบทเปเบญเบ. เปเบกเบทเปเบญเบเบปเบเบฅเบฒเบเบเบฒเบเบเบดเบกเปเปเป, Service เบเบฐ:
1.  เบเบฒเบงเปเบซเบผเบเบเปเปเบกเบนเบ PDF.
2.  เบชเบฑเปเบเบเบดเบกเปเบเบเบฑเบเปเบเบทเปเบญเบเบเบดเบกเบเบตเปเบฅเบฐเบเบธเปเบงเป.
3.  เปเบเปเบเบชเบฐเบเบฒเบเบฐเบเบฒเบเบเบดเบก (เบชเบณเปเบฅเบฑเบ เบซเบผเบท เบฅเบปเปเบกเปเบซเบผเบง) เบเบฑเบเบเบทเบเปเบเบเบฑเบ Server.

### 2. เปเปเบ API (เบชเบณเบฅเบฑเบเบชเบฑเปเบเบเบฒเบเปเบเบเบเบปเบ)
เบเบญเบเบเบฒเบเปเปเบเบญเบฑเบเบเบฐเปเบเบกเบฑเบ, เบเบฑเบเบกเบต API endpoints เบชเบณเบฅเบฑเบเปเบซเปเบฅเบฐเบเบปเบ POS เปเบญเบตเปเบเปเบเปเปเบเบเบเบปเบ:

- `GET /list-printers`: เบเบถเบเบฅเบฒเบเบเบทเปเปเบเบทเปเบญเบเบเบดเบกเบเบฑเบเปเบปเบเบเบตเป OS เบฎเบนเปเบเบฑเบ.
- `POST /print/pdf`: เบฎเบฑเบเบเปเปเบกเบนเบ PDF (เปเบเบฎเบนเบเปเบเบ Base64) เบเปเบญเบกเบเบทเปเปเบเบทเปเบญเบเบเบดเบก เปเบเบทเปเบญเบชเบฑเปเบเบเบดเบกเปเบเบเบเบปเบ.
- `POST /hardware/open-drawer`: เบชเบฑเปเบเปเบเบตเบเบฅเบดเปเบเบเบฑเบเปเบเบฑเบเปเบเบดเบเบเบตเปเปเบเบทเปเบญเบกเบเปเปเบเปเบฒเบ USB.

---

## ๐ เบเบฒเบเบเบดเบเบเบฑเปเบ (เบชเบณเบฅเบฑเบเบเบนเปเปเบเปเบเบฒเบเบเบปเปเบงเปเบ - Windows)

1.  เบเบฒเบงเปเบซเบผเบเปเบเบฅเป `POS_Bridge_Setup_vX.X.X.exe`.
2.  เบเบฅเบดเบเบเบงเบฒเปเบชเปเปเบเบฅเป Setup เปเบฅเปเบงเปเบฅเบทเบญเบ **"Run as administrator"**.
3.  เบเบปเบ Next เปเบเบเบฒเบกเบเบฑเปเบเบเบญเบเบเบปเบเบชเบณเปเบฅเบฑเบ.
4.  **เบชเบณเบเบฑเบ:** เบซเบผเบฑเบเบเบดเบเบเบฑเปเบ, เปเบซเปเปเบเบเบตเป `C:\Program Files\pos-bridge-service` (เบซเบผเบท Folder เบเบตเปเบเบดเบเบเบฑเปเบ) เปเบฅเปเบงเปเบเปเปเบเปเบเบฅเป `config.json` เปเบซเปเบเบตเปเปเบเบซเบฒ API Server เบเบญเบเบเปเบฒเบ.
5.  Restart Service เบซเบผเบท Restart เบเบญเบกเบเบดเบงเปเบเบต.

**เบงเบดเบเบตเบเบงเบเบชเบญเบเบงเปเบฒ Service เปเบฎเบฑเบเบงเบฝเบเบขเบนเปเบซเบผเบทเบเปเป:**
1.  เปเบเบตเบเปเบเบฃเปเบเบฃเบก **Services** (เบเบดเบก `services.msc` เปเบเธเนเธญเธ Run).
2.  เบเบญเบเบซเบฒ Service เบเบตเปเบเบทเปเบงเปเบฒ **"service print pos app"** เปเบฅเบฐเบเบงเบเปเบเบดเปเบเบงเปเบฒเบชเบฐเบเบฒเบเบฐเปเบเบฑเบ **Running**.
3.  เปเบเบตเบ Web Browser เปเบฅเปเบงเปเบเบปเปเบฒเปเบเบเบตเป `http://localhost:9100/list-printers`. เบเปเบฒเปเบซเบฑเบเบฅเบฒเบเบเบทเปเปเบเบทเปเบญเบเบเบดเบก, เบชเบฐเปเบเบเบงเปเบฒ Service เปเบฎเบฑเบเบงเบฝเบเบชเบณเปเบฅเบฑเบ.

---

## ๐ฆ Dependencies เบซเบผเบฑเบ

- **express, cors, body-parser:** เบชเบณเบฅเบฑเบเบชเปเบฒเบ Web Server เปเบฅเบฐ เบเบฑเบเบเบฒเบ API request.
- **escpos & escpos-usb:** เปเบเปเบชเบณเบฅเบฑเบเบชเบปเปเบเบเบณเบชเบฑเปเบเปเบเบเบเบปเบเปเบเบซเบฒเบญเบธเบเบฐเบเบญเบเปเบเบฑเปเบ: เปเบเบตเบเบฅเบดเปเบเบเบฑเบเปเบเบฑเบเปเบเบดเบ.
- **pkg:** เปเบเป Build เปเบเบฃเปเบเบฑเบ Node.js เปเบซเปเปเบเบฑเบเปเบเบฅเป `.exe` เบเบตเปเบชเบฒเบกเบฒเบเปเบญเบปเบฒเปเบเปเบเปเบเบฒเบเปเบเปเปเบฅเบตเบ.
- **nssm:** เปเบเบทเปเบญเบเบกเบทเบชเบณเบฅเบฑเบเบชเปเบฒเบ เปเบฅเบฐ เบเบฑเบเบเบฒเบ Windows Service.
- **SumatraPDF:** (เบชเบณเบฅเบฑเบ Windows) เปเบเบฃเปเบเบฃเบกเบเบตเปเปเบเปเปเบเบเบฒเบเบชเบฑเปเบเบเบดเบกเปเบเบฅเป PDF เปเบเบเบเบฝเบเป (Silent Print).

---

## ๐จโ๐ป เบเบฒเบเบเบฑเบเบเบฐเบเบฒ (เบชเบณเบฅเบฑเบเบเบฑเบเบเบฑเบเบเบฐเบเบฒ)

### 1. เบเบฝเบกเปเบเบทเปเบญเบเบกเบทเบเบตเปเบเบณเปเบเบฑเบ:
- **Node.js:** เปเบงเบตเบเบฑเบ 18 เบเบถเปเบเปเบ.
- **Git:** เบชเบณเบฅเบฑเบ Clone เปเบเบผเปเบเบฑเบ.
- **(เบชเบณเบฅเบฑเบ Windows):**
    - **NSIS:** เบเบฒเบงเปเบซเบผเบ เปเบฅเบฐ เบเบดเบเบเบฑเปเบ [NSIS](https://nsis.sourceforge.io/Download) เปเบเบทเปเบญเบชเปเบฒเบ Installer.
    - **SumatraPDF.exe:** เบเบฒเบงเปเบซเบผเบเปเบเบฅเป Portable Executable เบเบฒเบ [SumatraPDF Website](https://www.sumatrapdfreader.org/download-free-pdf-viewer).

### 2. Clone เปเบเบผเปเบเบฑเบ เปเบฅเบฐ เบเบดเบเบเบฑเปเบ Dependencies:
```bash
git clone <your-repository-url>
cd <project-folder>
npm install
```

### 3. เบชเปเบฒเบเปเบเบฅเป `config.json`:
เบชเปเบฒเบเปเบเบฅเป `config.json` เบเบฒเบกเบเบปเบงเบขเปเบฒเบเบเปเบฒเบเปเบเบดเบ เปเบเบทเปเบญเปเบซเปเบชเบฒเบกเบฒเบเบเบปเบเบชเบญเบเปเปเบ Polling เปเบเป.

### 4. เบฅเบญเบ Run Server เปเบเปเปเบ Development:
```bash
node server.js
```
เบเปเบฒเบเปเปเบกเบตเบซเบเบฑเบเบเบดเบเบเบฒเบ, เบเบฐเปเบซเบฑเบเบเปเปเบเบงเบฒเบก Log เบเบฒเบเปเบฎเบฑเบเบงเบฝเบ เปเบฅเบฐ Server เบเบฐเบเปเบญเบกเบฎเบฑเบเบเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเบตเป `http://localhost:9100`.

### 5. เบเบฒเบ Build เปเบเบฅเป Executable (.exe) เบชเบณเบฅเบฑเบ Windows:
```bash
npm run build
```
เบเบณเบชเบฑเปเบเบเบตเปเบเบฐเบชเปเบฒเบเปเบเบฅเป `PosBridge.exe` เบเบถเปเบเบกเบฒ.

### 6. เบเบฒเบเบชเปเบฒเบเบเบปเบงเบเบดเบเบเบฑเปเบ (Installer) เบชเบณเบฅเบฑเบ Windows:
1.  เปเบซเปเปเบเปเปเบเบงเปเบฒเปเบเบฅเป `PosBridge.exe`, `nssm.exe`, `SumatraPDF.exe` เปเบฅเบฐ `config.json` (เบชเบณเบฅเบฑเบ default) เบขเบนเปเปเบ Folder เบเบฝเบงเบเบฑเบเบเบฑเบ `create_installer.nsi`.
2.  เบเบฅเบดเบเบเบงเบฒเปเบชเปเปเบเบฅเป `create_installer.nsi` เปเบฅเปเบงเปเบฅเบทเบญเบ **"Compile NSIS Script"**.
3.  เบเปเบฒเบชเบณเปเบฅเบฑเบ, เบเบฐเปเบเปเปเบเบฅเป Setup เบญเบญเบเบกเบฒ.

---
## เบเบนเปเบเบฑเบเบเบฐเบเบฒ

- **SornDev เบเบฑเบเบเบฐเบเบฒเบเปเบญเบเปเบง**
- **Facebook:** [https://www.facebook.com/SornDev](https://www.facebook.com/SornDev)
- **เปเบ/WhatsApp:** 020 28729723
