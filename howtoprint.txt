Server (Laravel): เบชเปเบฒเบ PDF.

Client (Vue/POS Bridge): เปเบเปเบฎเบฑเบเบเบณเบชเบฑเปเบเบเปเบญเบก URL/Data -> เบเบดเบก.

เบชเบฐเบเบฒเบเบฐเบเบฑเบเบเบธเบเบฑเบ: Service Bridge เปเบฅเปเบเปเบเปเปเบฅเปเบง (/list-printers เปเบเปเปเบเป), เบชเบฐเบเบฑเปเบเบเบฑเบเบซเบฒ Network Permission เบเบตเปเปเบเบตเบเบกเบตเบเปเปเปเบเปเบเบทเบเปเบเปเปเบเปเบฅเปเบง.

เบเปเปเปเบเบเบตเปเปเบกเปเบเบเบฑเปเบเบเบญเบเบเบตเปเบชเบปเบกเบเบนเบเปเบเบเบชเบณเบฅเบฑเบ Vue.js เปเบเบทเปเบญเบเบฑเบเบเบฒเบเบเบฒเบเบเบดเบก เปเบเบเบดเบ (Receipt) เปเบฅเบฐ เปเบเบชเบฑเปเบเบญเบฒเบซเบฒเบ (Kitchen Ticket) เบเบตเปเบเบทเบเบชเปเบฒเบเบเบฒเบ Server (Laravel).

๐ป เบเบปเบงเบขเปเบฒเบ Vue.js: เบเบฒเบเบเบฑเบเบเบฒเบเบเบฒเบเบเบดเบกเบเบฒเบ Server
เปเบเบชเบฐเบเบฒเบเบฐเบเบฒเบเบเบตเป, เบซเบผเบฑเบเบเบฒเบเบเบฒเบเบชเบฑเปเบเบเบทเปเบชเบณเปเบฅเบฑเบ, Laravel Server เบเบงเบเบชเบปเปเบ URL เบเบญเบเปเบเบฅเป PDF เบเบตเปเบเบทเบเบชเปเบฒเบเบเบถเปเบเบกเบฒเปเบซเป Vue.

1. เปเบเบเบชเปเบฒเบเบเปเปเบกเบนเบเบเบตเปเบเบงเบเปเบเปเบฎเบฑเบเบเบฒเบ Server (Laravel)
เบชเบปเบกเบกเบธเบเบงเปเบฒ API เบเบญเบ Laravel เบชเบปเปเบเบเปเปเบกเบนเบเบเบตเปเบเบทเบเปเบซเป Vue เบซเบผเบฑเบเบเบฒเบเปเบฎเบฑเบเบเบธเบฅเบฐเบเบณเบชเบณเปเบฅเบฑเบ:

JSON

{
    "success": true,
    "message": "Order placed successfully.",
    "print_data": {
        "receipt_url": "https://your-server.com/receipts/R-20251110-101.pdf",
        "kitchen_url": "https://your-server.com/tickets/T-20251110-101-kitchen.pdf",
        "printer_map": {
            "receipt": "POS-RECEIPT-PRINTER", // เบเบทเปเปเบเบทเปเบญเบเบเบดเบกเปเบเบเบดเบ
            "kitchen": "POS-KITCHEN-PRINTER"  // เบเบทเปเปเบเบทเปเบญเบเบเบดเบกเบชเบฑเปเบเบญเบฒเบซเบฒเบ
        }
    }
}
2. เปเบเบ Vue Method (Client Side Logic)
เปเบฎเบปเบฒเบเบฐเบชเปเบฒเบเบเบฑเบเบเบฑเบเบเบตเปเบเบฑเบเปเบเบเปเบเบทเปเบญเบเบฑเบเบเบฒเบเบเบฒเบเบเบดเบกเปเบเบ Sequential (เปเบเบทเปเบญเบฅเบฐเบญเบฑเบ) เปเบเบเปเบเป Endpoint /print/pdf-url เบเบตเปเปเบฎเบปเบฒเปเบเปเบชเปเบฒเบเปเบงเป.

JavaScript

import axios from 'axios';

export default {
    data() {
        return {
            bridgeUrl: 'http://localhost:9100',
        };
    },
    methods: {
        /**
         * เบเบฑเบเบเบฑเบเบชเบณเบฅเบฑเบเบชเบฑเปเบเบเบดเบก PDF เปเบเบเปเบเป URL (เปเบเบเบซเบผเบฑเบ)
         * @param {string} url - URL เปเบเบฑเบกเบเบญเบเปเบเบฅเป PDF
         * @param {string} printerName - เบเบทเป Windows Driver
         */
        async triggerPrintByUrl(url, printerName) {
            console.log(`Sending to Bridge: URL=${url}, Printer=${printerName}`);
            
            try {
                const payload = {
                    pdfUrl: url,
                    printerName: printerName
                };

                const response = await axios.post(`${this.bridgeUrl}/print/pdf-url`, payload);
                
                if (response.data.success) {
                    console.log(`[SUCCESS] Printed to ${printerName}.`);
                    return true;
                } else {
                    // เบเปเบฒ Bridge เบเบญเบเบงเปเบฒ: เบเบดเบกเบเบดเบเบเบฒเบ (เปเบเบฑเปเบ: เปเบเบทเปเบญเบเบเบดเบกเบเบดเบ)
                    console.error(`[BRIDGE ERROR] Printing failed on ${printerName}:`, response.data.message);
                    alert(`Error เบเบดเบก ${printerName}: ${response.data.message}`);
                    return false;
                }
            } catch (error) {
                // เบเปเบฒเบเปเปเบชเบฒเบกเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเบฑเบ Bridge เปเบเป
                console.error('Network Error: Bridge is unreachable.', error);
                alert('CRITICAL ERROR: เบเปเปเบชเบฒเบกเบฒเบเปเบเบทเปเบญเบกเบเปเปเบเบฑเบ POS Bridge เปเบเป.');
                return false;
            }
        },

        /**
         * เบเบฑเบเบเบฑเบเบเบฑเบเบเบฒเบเบเบฒเบเบเบดเบกเบเบฑเบเปเบปเบเบซเบผเบฑเบเบเบฒเบเบชเบฑเปเบเบเบทเป
         * @param {object} printData - เบเปเปเบกเบนเบเบเบตเปเปเบเปเบฎเบฑเบเบเบฒเบ Server (เปเบเบดเปเบเปเบเบเบชเปเบฒเบเบเปเบฒเบเปเบเบดเบ)
         */
        async handleOrderCompletePrint(printData) {
            alert('เบเบณเบฅเบฑเบเบเบณเปเบเบตเบเบเบฒเบเบเบดเบก: เปเบเบเบดเบ เปเบฅเบฐ เปเบเบชเบฑเปเบเบญเบฒเบซเบฒเบ...');

            const { receipt_url, kitchen_url, printer_map } = printData;

            // --- 1. เบเบดเบกเปเบเบเบดเบ (Receipt) ---
            const receiptSuccess = await this.triggerPrintByUrl(
                receipt_url, 
                printer_map.receipt
            );

            // เบเปเบฒเปเบเบเบดเบเบเบดเบกเบชเบณเปเบฅเบฑเบ, เปเบซเปเปเบเบเบดเบกเปเบเบชเบฑเปเบเบญเบฒเบซเบฒเบเบเปเป
            if (receiptSuccess) {
                // --- 2. เบเบดเบกเปเบเบชเบฑเปเบเบญเบฒเบซเบฒเบ (Kitchen Ticket) ---
                await this.triggerPrintByUrl(
                    kitchen_url, 
                    printer_map.kitchen
                );
            }
            
            alert('เบเบฐเบเบงเบเบเบฒเบเบเบดเบกเบชเบณเปเบฅเบฑเบเปเบฅเปเบง.');
        }

        // ... (other methods)
    }
}
3. เบเบฑเปเบเบเบญเบเบเบฒเบเปเบฎเบฑเบเบงเบฝเบเบเบตเปเปเบเบฐเบเปเบฒ
Server (Laravel) Action: เบซเบผเบฑเบเบเบฒเบเบชเปเบฒเบ Order เบชเบณเปเบฅเบฑเบ, เปเบเบ Laravel เบเบงเบเบชเปเบฒเบเปเบเบฅเป PDF เบเบฑเบเบชเบญเบ (receipt.pdf, kitchen.pdf) เปเบฅเบฐ เปเบเบฑเบเปเบงเปเปเบ Server.

Server Response: Laravel เบชเบปเปเบ Response เบเบตเปเบกเบต print_data (เบฅเบงเบกเบเบฑเบ URL เบเบญเบเปเบเบฅเป) เบเบฑเบเบเบทเบเปเบเบซเบฒ Vue.

Vue Action: เบเบฑเบเบเบฑเบ handleOrderCompletePrint() เบเบทเบเปเบญเบตเปเบเปเบเป.

Bridge Download & Print: Bridge App เบเบตเป Port 9100 เบฎเบฑเบ URL -> เบเบฒเบงเปเบซเบผเบเปเบเบฅเป (เปเบเป axios เปเบ Bridge) -> เบชเบปเปเบเปเบเบเบดเบกเปเบเบเปเบเป Driver เบเบญเบ Windows.

เบเปเบงเบเบงเบดเบเบตเบเบตเป, เบเปเบฒเบเบชเบฒเบกเบฒเบเบเบฑเบเบเปเบฝเบ Logic เบเบญเบเบเบฒเบเบเบดเบกเปเบ Laravel เปเบเปเบเปเบฒเบ, เปเบฅเบฐ Client (Vue) เบเบฐเบกเบตเปเปเบฒเบเบตเปเบเบฝเบเปเบเปเปเบเบฑเบเบเบนเปเบชเบฑเปเบเบเบฒเบ (Commander) เปเบซเป Bridge เปเบฎเบฑเบเบงเบฝเบเปเบเบปเปเบฒเบเบฑเปเบ.เปเบณ